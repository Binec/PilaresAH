<!DOCTYPE html>
<html>
 <head>
 <meta charset="UTF-8">
 <title>Formulario de contacto</title>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-serialize-object/2.5.0/jquery.serialize-object.min.js"></script>
 </head>
 <script>
    <script>
   
</script>
 </script>
 <body>
 <form id="contact-form">
 <h2>Formulario de contacto</h2>
 <p>
 <label>Nombre<br><input type="text"  name="nombre"></label><br>
 <label>Email<br><input type="email" name="email"></label><br>
 <label>Comentarios<br></label><textarea name="comentarios" cols=40 rows=5></textarea></label>
 </p>
 <input id="submit-contact-form" type="submit" value="Submit">
 </form>
 <script>
const form = document.querySelector("#form")
   const submitButton = document.querySelector("#submit")
   const scriptURL = 'https://script.google.com/macros/s/AKfycbxOZB0rG3B6WwpPHAwp9t0kPY41QVVoI52honTg6UZeSIuB-5RQ1Imd3R_lcMBII-VH/exec'

   form.addEventListener('submit', e => {
     submitButton.disabled = true
     e.preventDefault()
     let requestBody = new FormData(form)
     fetch(scriptURL, { method: 'POST', body: requestBody})
       .then(response => {
          alert('Success!', response)
          submitButton.disabled = false
         })
       .catch(error => {
       alert('Error!', error.message)
         submitButton.disabled = false

       }
       )
   })


 (function() {
 var $form = $('form#contact-form'), url = 'https://script.google.com/macros/s/AKfycbwvbTDNkm80FppBdqeF9M9lk7m7em0fAVZ7y4JG_Bw59S306DYr8gvem8p2cLIPKD43VQ/exec';
 $('#submit-contact-form').on('click', function(e) {
 e.preventDefault();
 var jqxhr = $.ajax({
 url: url,
 method: "GET",
 dataType: "json",
 data: $form.serializeObject(),
 success: function(data) {
 console.log(data);
 $('form#contact-form').hide();
 $('body').append("<p style='color:green'>Gracias por tu inter√©s. Contactaremos contigo en breve.</p>");
 }
 });
 });
 })();
 </script>
 </body>
</html>